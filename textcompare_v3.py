import openpyxlimport shutilimport datetimeimport osimport refrom openpyxl.styles import Color, PatternFill, Font, Borderfrom openpyxl.styles import colorsfrom openpyxl.cell import CellredFill = PatternFill(start_color='FFEE1111', end_color='FFEE1111', fill_type='solid')def Prod_ID_Block_baseline(s, n):                for start in range(25, len(s), n):                                         yield s[start:start+n]##### Main script start here ########$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$now = datetime.datetime.now()shutil.rmtree('C:/Test1/MasterFile/')os.mkdir('C:/Test1/MasterFile/')Master_workbook = openpyxl.Workbook()Master_workbook.create_sheet("Compare")Master_Compare_sheet = Master_workbook ['Compare']#Master_File_Loc = "C:/Test1/MasterFile/Master_File.xlsx"#Master_workbook = openpyxl.load_workbook(Master_File_Loc,read_only = False)#Master_Compare_sheet = Master_workbook ['Compare']# Clear MasterSheet#for rows in Master_Compare_sheet['A2:C'+ str(Validation_Rows)]:#  for x in range(3,Validation_Rows):    #cell.value = ""#    if rows == "None":#            rows[x].value.delete            #continueTC_Row1 = 2    for file in os.listdir("C:/Test1/Baseline"):    if file.endswith(".dat"):        Test1 = os.path.join("C:/Test1/Baseline", file)        Test2 = os.path.join("C:/Test1/FilesToCompare", file)        Master_Compare_sheet.cell(row =TC_Row1,column = 1).value = Test1[len(Test1) - 20: len(Test1)-13]        Master_Compare_sheet.cell(row =TC_Row1,column = 2).value = Test1        Master_Compare_sheet.cell(row =TC_Row1,column = 3).value = Test2            TC_Row1 = TC_Row1 +1Master_workbook.save("C:/Test1/MasterFile/Master_File.xlsx")Validation_Rows = Master_Compare_sheet.max_rowTC_Row = 2os.mkdir('C:/Test1/Logs/'+ now.strftime("%Y-%m-%d-%H-%M-%S"))for No_Files in range(2, Validation_Rows-3):    print (TC_Row)    Product_Name = Master_Compare_sheet.cell(row =TC_Row,column = 1).value     Baseline_File = Master_Compare_sheet.cell(row =TC_Row,column = 2).value    File_To_Compare = Master_Compare_sheet.cell(row =TC_Row,column = 3).value    print(Product_Name, Baseline_File, File_To_Compare)    #$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$    List_Block_Baseline= list()    List_Block_New= list()    List_Block_Baseline1 = list()    List_Block_New1 = list()    Master_File = Baseline_File    File_To_Compare = Baseline_File    Baseline_File = open(Master_File, 'r')    FileCompare = open(File_To_Compare, 'r')    #FO = open('C:/Test1/Logs/Log11.txt', 'w')    # Make each line in a list for baseline and new files    list1=Baseline_File.readlines()    list2=FileCompare.readlines()    # Get no of lines for baseline and new files    Baseline_No_Rows = len(list1)    FileToCompare_No_Rows = len(list2)     # Split Line of data into 6 blocks for baseline files    for r in range(1, Baseline_No_Rows-1):        Baseline_Value = list1[r]           for Prod_ID_Block in Prod_ID_Block_baseline(Baseline_Value, 240):            List_Block_Baseline.append(Prod_ID_Block)    # Split Line of data into 6 blocks for new files    for r in range(1, FileToCompare_No_Rows-1):        New_Value = list2[r]            for Prod_ID_Block in Prod_ID_Block_baseline(New_Value, 240):            List_Block_New.append(Prod_ID_Block)    List_Block_Baseline = list(filter(None, List_Block_Baseline))    List_Block_New = list(filter(None, List_Block_New))    Baseline_No_PCID = len(List_Block_Baseline)    FileToCompare_No_PCID =  len(List_Block_New)    print (Baseline_No_PCID, FileToCompare_No_PCID);    for i in range(0,Baseline_No_PCID):        test = List_Block_Baseline[i]        Acc = test[22:37].strip()        PCID = test[152:162].strip()        if (PCID != ""):            List_Block_Baseline1.append(PCID)    for i in range(0,FileToCompare_No_PCID):        test = List_Block_New[i]        Acc = test[22:37].strip()        PCID = test[152:162].strip()        if (PCID != ""):            List_Block_New1.append(PCID)    Master_List = list(set(List_Block_Baseline1+List_Block_New1))    No_PCID = len(Master_List)       #Master_File_Loc = "C:/Test1/MasterFile/Master_File1"+ Product_Name + ".xlsx"    #Master_workbook = openpyxl.load_workbook(Master_File_Loc,read_only = False)    Master_workbook1 = openpyxl.Workbook()    Master_workbook1.create_sheet("Compare1")    Master_Compare_sheet1 = Master_workbook1 ['Compare1']    for i in range(2,No_PCID+2):        Master_Compare_sheet1.cell(row =i+1,column = 1).value = Master_List[i-2]    Master_workbook1.save('C:/Test1/Logs/'+ now.strftime("%Y-%m-%d-%H-%M-%S")+ '/' + Product_Name+".xlsx")   # Master_workbook1.save(Master_File_Loc)    TC_Row = TC_Row + 1#FO.close()print ( "Poster files compare completed. Please check Logs folder for results!")